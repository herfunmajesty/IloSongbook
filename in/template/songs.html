<!doctype html>

<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel="stylesheet">
<title>Krakow Ukulele & Sing Tuesdays</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    
<style>
<style>
.highlight {background-color: lemonchiffon; font-weight: bold;}
.chord { font-weight: bold; color:red}
ul { list-style: none; padding-left: 0px; }
#options a {text-decoration: underline;}
#songs a {text-decoration: none;}
@import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');
.montserrat-h3 {
	font-family: 'Montserrat', sans-serif;
	font-weight: 300; /* Waga 300 odpowiada Montserrat Light */
}
.toggle-button {
	background-color: #eee;
	border: 3px solid #ccc;
	padding: 3px 5px;
	margin-right: 5px;
	cursor: pointer;
}
.bold-text {
    font-weight: bold;
    font-style: normal; 
	}
.italic-text {
	font-style: italic;
    font-weight: normal;
	}	
</style>

</head>
<body>

<header class="container">
    <div class="m-2 mb-4 text-center">
        <img src="/images/ukulele-krakow.png" class="img-fluid" alt="Krakow Ukulele" width="200">
    </div>
</header>

<div class="container">
<div class="row justify-content-center">
    
    <div id="list" class="col-lg-8 col-md-10 col-sm-12 my-3"> <!-- zachowania kontenerÃ³w dla rÃ³Å¼nych typÃ³w ekranÃ³w + margin-->

        <h4>Krakow Ukulele & Sing Tuesdays</h4>
        <div class="row row-cols-2">
            <div class="col-md-6">
                <div>
                    <h6>Filter</h6>
                    <form id="filter-form">
						<div class="btn-group-vertical">
							<button type="button" name="Easy" class="toggle-button btn btn-outline-success">Easy</button>
							<button type="button" name="Medium" class="toggle-button btn btn-outline-warning">Medium</button>
							<button type="button" name="Hard" class="toggle-button btn btn-outline-danger">Hard</button>
							<button type="button" name="New" class="toggle-button btn btn-outline-info">ðŸ”¥ Only new</button>
						</div>
					</form>
                </div>
            </div>
			<!--<div class="col-md-1">
			</div>-->
            <div class="col-md-6 d-flex justify-content-end">
                <div>
                    <h6>Sort by</h6>
						<div class="btn-group-vertical">
							<button type="button" id="sortByTitle" class="toggle-button btn btn-outline-primary">  Titles  </button>
							<button type="button" id="sortByArtist" class="toggle-button btn btn-outline-primary"> Artists </button>
						</div>
						<div id="virtual-click-area" style="display: none; border: 2px solid red;"></div>
                </div>
            </div>
			
        </div>
		<!-- <div id="infoBox" style="position: fixed; right: 20px; top: 20px; border: 1px solid black; padding: 10px;">
			<p id="sorting method" style="font-size: xx-small;"></p>
		</div> 
		Robocze elementy do sprawdzania trybu sortowania 
		-->
		<!--<p id="sorting method"></p>-->
		
		
        <div class="mt-2">
			<h6>Songs</h6>
			<ul id="songs">
				{% for song in songs %}
					<li>
						<a href="{{song.html_name}}.html" name="{{song.Number}}">
						{{song.Number}} - {{song.Title}} - 
						</a>
						<small>
							<em> {{song.Artist}} -	</em> 
						</small>
						<span class="text-{{song.l_tr}}" >
							<small><b>{{song.Level}}</b></small>
						</span>
					</li>
				{% endfor %}
			</ul>
		</div>
       
    </div>

    <hr/>
			
    <div class="m-2 my-4 text-center">
        <img src="/images/qrcode.png" class="img-fluid" alt="QR Code" width="200">
    </div>
	<!--<div class="m-2 my-4 text-center"><li><a href="archive/archive.html">Archiwum</a></li>
	<li><a href="new/test.html">Test</a></li>
	</div>-->


</div>
</div>


<script>
	document.addEventListener('DOMContentLoaded', () => {
		const toggleButtons = document.querySelectorAll('.toggle-button');
		const savedState = JSON.parse(sessionStorage.getItem('buttonState'));
		const songsList = document.getElementById('songs'); // ID twojej listy piosenek
		console.log('Zachowane stany przyciskow: ', savedState);
		if (savedState === null) {
			// Jesli savedState jest null, oznacz wszystkie przyciski jako aktywne
			toggleButtons.forEach(button => {
				if (button.name !== 'New') {
					button.classList.add('active');
				}
			});
		} else {
			// W przeciwnym razie odczytaj stan przyciskow z sessionStorage
			toggleButtons.forEach(button => {
				if (button.name !== 'New') {
					if (savedState.includes(button.name)) {
						button.classList.add('active');
					}
				}
			});
		}
	
		toggleButtons.forEach(button => {
			// Dla przyciskow wszystkich bez wyjatku
			button.addEventListener('click', () => {
				button.classList.toggle('active');
				console.log('zmiana stany przyciskow: ', button.name);
				filterSongs();
				saveButtonState();
				document.getElementById('virtual-click-area').click();
			});
		});
		toggleButtons.forEach(button => {
			console.log(`Przycisk "${button.name}" jest ${button.classList.contains('active') ? 'aktywny' : 'nieaktywny'}`);
		});
		function saveButtonState() {
			const activeButtons = Array.from(toggleButtons).filter(btn => btn.classList.contains('active'));
			sessionStorage.setItem('buttonState', JSON.stringify(activeButtons.map(btn => btn.name)));
		}
		function filterSongs() {
			const activeButtons = document.querySelectorAll('.toggle-button.active');
			console.log("Aktywne przyciski: ", activeButtons);
			const allSongs = songsList.querySelectorAll('li');

			allSongs.forEach(song => {
				const level = song.querySelector('span small b').textContent;
				var shouldDisplay = Array.from(activeButtons).some(btn => btn.name === level);
				song.style.display = shouldDisplay ? 'block' : 'none';
				activeButtons.forEach(button => {
					if (button.name === 'New') {
						const title = song.querySelector('a').textContent;
						shouldDisplay = title.includes('ðŸ”¥');
						if (song.style.display === 'block'){
							song.style.display = shouldDisplay ? 'block' : 'none';}
					}
				});
			});
		}
		// Dodaj nasÅ‚uchiwanie na wirtualnym elemencie
        document.getElementById('virtual-click-area').addEventListener('click', () => {
            console.log('Wirtualny obiekt zostaÅ‚ klikniÄ™ty!');
		});
	});
</script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const songsList = document.getElementById('songs'); // ID twojej listy piosenek
        const sortByTitleButton = document.getElementById('sortByTitle');
        const sortByArtistButton = document.getElementById('sortByArtist');
		const myArtElements = document.querySelectorAll('.my-art'); // ZnajdÅº wszystkie elementy o klasie "my-art"
		const myLevElements = document.querySelectorAll('.my-lev'); // ZnajdÅº wszystkie elementy o klasie "my-lev"
		//sortByTitleButton.checked = true; // Zaznacz pole wyboru
		// Wylacz przycisk "Sort by Artist" na poczatku
        sortByArtistButton.classList.remove('active');

        sortByTitleButton.addEventListener('click', () => {
            sortByTitle();
            sortByArtistButton.classList.remove('active'); // Wylacz drugi przycisk
            sortByTitleButton.classList.add('active'); // Zaznacz pierwszy przycisk
			var s_variant=true;
			// Aktualizuj wartoÅ›ci w infoBox ROBOCZO
			//document.getElementById('sorting method').textContent = 'sort by title: ' + s_variant;
        });

        sortByArtistButton.addEventListener('click', () => {
            sortByArtist();
            sortByTitleButton.classList.remove('active'); // Wyè‰‚è†®cz pierwszy przycisk
            sortByArtistButton.classList.add('active'); // Zaznacz drugi przycisk
			s_variant=false;
			// Aktualizuj wartoÅ›ci w infoBox ROBOCZO
			//document.getElementById('sorting method').textContent = 'sort by title: ' + s_variant;
        });
		
        function sortByTitle() {
			const sortedSongs = Array.from(songsList.querySelectorAll('li'))
            .sort((a, b) => {
				// Pobierz nazwè‡‹ z atrybutu href
				var nameA = a.querySelector('a').getAttribute('href');
				var nameB = b.querySelector('a').getAttribute('href');
				nameA = nameA.replace(/^ðŸ”¥/i, '');
				nameB = nameB.replace(/^ðŸ”¥/i, '');
				nameA = nameA.replace(/^ðŸŽ‚/i, '');
				nameB = nameB.replace(/^ðŸŽ‚/i, '');
				// PorÃ³wnaj nazwy
				return nameA.localeCompare(nameB);
				
				// WyÅ›wietl wartotci artystÃ³w w konsoli
				//console.log('Title A:', nameA);
				//console.log('Title B:', nameB);
				
                return nameA.localeCompare(nameB);
				
            });
			songsList.innerHTML = ''; // Wyczysc liste
			sortedSongs.forEach(song => songsList.appendChild(song));
			
			var allLiElements = document.querySelectorAll('li'); // Pobierz wszystkie elementy <li>. Uwaga! nie moÅ¼e istnieÄ‡ inny element typu <li>
			allLiElements.forEach(function (myLi) {
				var EmElement = myLi.querySelector('em');
				var anchorElement = myLi.querySelector('a'); // Pobierz element <a>
				myLi.insertBefore(anchorElement, EmElement); // PrzenieÅ› element small em przed elementem <a>
			});
        }

        function sortByArtist() {
			const sortedSongs = Array.from(songsList.querySelectorAll('li'))
				.sort((a, b) => {
					var artistA = a.querySelector('em').textContent;
					artistA = artistA.replace(/^\s*The\s+/i, ''); //usuwanie Å›mieci napotrzeby sotowania
					artistA = artistA.replace(/^\s+/, ''); 
					//console.log('artistA : ', artistA);
					
					var artistB = b.querySelector('em').textContent;
					artistB = artistB.replace(/^\s*The\s+/i, '');
					artistB = artistB.replace(/^\s+/, '');
					//console.log('artistB : ', artistB);
					

					return artistA.localeCompare(artistB, 'en', { sensitivity: 'base' });
				});
			songsList.innerHTML = ''; // Wyczysc liste
			sortedSongs.forEach(song => songsList.appendChild(song));
			
			var allLiElements = document.querySelectorAll('li'); // Pobierz wszystkie elementy <li>
			allLiElements.forEach(function(myLi, index) {
				var SmallEmElement = myLi.querySelector('em');
				//console.log(`Iteracja ${index}:`, SmallEmElement);
				//console.log(`Iteracja ${index}:`, myLi.querySelector('a'));

				myLi.insertBefore(SmallEmElement, myLi.querySelector('a'));
			});
		}
		
	});
</script>
</body>
</html>
